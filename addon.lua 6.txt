--// Treo Tien Script - LMT
--// Anti AFK 20p + Fix Lag + Timer

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Anti AFK
player.Idled:Connect(function()
	VirtualUser:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
	task.wait(1)
	VirtualUser:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
end)

-- Nh√¢n v·∫≠t ng·ªìi im
local function sitCharacter()
	if player.Character and player.Character:FindFirstChild("Humanoid") then
		local hum = player.Character.Humanoid
		hum.WalkSpeed = 0
		hum.JumpPower = 0
		hum.Sit = true
	end
end
sitCharacter()

-- GUI
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.ResetOnSpawn = false

-- Menu tr√≤n
local circle = Instance.new("TextButton", gui)
circle.Size = UDim2.fromOffset(30,30)
circle.Position = UDim2.fromScale(0.05,0.5)
circle.Text = "‚öôÔ∏è"
circle.BackgroundColor3 = Color3.fromRGB(40,40,40)
circle.TextScaled = true
circle.AutoButtonColor = false
Instance.new("UICorner", circle).CornerRadius = UDim.new(1,0)

-- Menu ch√≠nh
local main = Instance.new("Frame", gui)
main.Size = UDim2.fromOffset(350,300)
main.Position = UDim2.fromScale(0.35,0.3)
main.BackgroundColor3 = Color3.fromRGB(25,25,25)
main.Visible = false
Instance.new("UICorner", main).CornerRadius = UDim.new(0,20)

-- K√©o menu
local function drag(obj)
	local dragging, dragInput, startPos, startInput
	obj.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.Touch or i.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			startPos = obj.Position
			startInput = i.Position
		end
	end)
	obj.InputEnded:Connect(function()
		dragging = false
	end)
	UserInputService.InputChanged:Connect(function(i)
		if dragging and (i.UserInputType == Enum.UserInputType.Touch or i.UserInputType == Enum.UserInputType.MouseMovement) then
			local delta = i.Position - startInput
			obj.Position = UDim2.new(
				startPos.X.Scale,
				startPos.X.Offset + delta.X,
				startPos.Y.Scale,
				startPos.Y.Offset + delta.Y
			)
		end
	end)
end
drag(circle)
drag(main)

circle.MouseButton1Click:Connect(function()
	main.Visible = not main.Visible
end)

-- Ti√™u ƒë·ªÅ
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,40)
title.Text = "ü™ùü¶ã Treo Ti·ªÅn Vui V·∫ª"
title.TextScaled = true
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1

-- Timer
local countdown = 380
local totalMinutes = 0

local timerLabel = Instance.new("TextLabel", main)
timerLabel.Position = UDim2.fromOffset(20,60)
timerLabel.Size = UDim2.fromOffset(300,30)
timerLabel.TextColor3 = Color3.new(1,1,1)
timerLabel.BackgroundTransparency = 1
timerLabel.TextScaled = true

-- Thanh ph√∫t
local minuteBar = Instance.new("TextLabel", main)
minuteBar.Position = UDim2.fromOffset(20,100)
minuteBar.Size = UDim2.fromOffset(300,30)
minuteBar.TextColor3 = Color3.fromRGB(0,255,120)
minuteBar.BackgroundTransparency = 1
minuteBar.TextScaled = true

-- FPS
local fpsLabel = Instance.new("TextLabel", main)
fpsLabel.Position = UDim2.fromOffset(20,140)
fpsLabel.Size = UDim2.fromOffset(300,30)
fpsLabel.TextColor3 = Color3.fromRGB(255,255,0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.TextScaled = true

-- Fix Lag
local fixLag = Instance.new("TextButton", main)
fixLag.Position = UDim2.fromOffset(75,190)
fixLag.Size = UDim2.fromOffset(200,40)
fixLag.Text = "Fix Lag (80%)"
fixLag.TextScaled = true
fixLag.BackgroundColor3 = Color3.fromRGB(60,60,60)
fixLag.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", fixLag)

fixLag.MouseButton1Click:Connect(function()
	settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
	for _,v in pairs(workspace:GetDescendants()) do
		if v:IsA("BasePart") then
			v.Material = Enum.Material.Plastic
			v.CastShadow = false
		end
	end
end)

-- FPS t√≠nh theo client (chu·∫©n Roblox)
local fps = 0
RunService.RenderStepped:Connect(function(dt)
	fps = math.floor(1/dt)
	fpsLabel.Text = "FPS: "..fps
end)

-- ƒê·∫øm ng∆∞·ª£c
task.spawn(function()
	while true do
		task.wait(1)
		countdown -= 1
		if countdown <= 0 then
			totalMinutes += math.floor(380/60)
			countdown = 380
		end
		timerLabel.Text = "‚è≥ C√≤n l·∫°i: "..countdown.." gi√¢y"
		minuteBar.Text = "üïí Ph√∫t treo: "..totalMinutes
	end
end)
